{"event": "EXPERIMENT_START", "config": {"experiment_id": "run_002_gpt4_moe_expert_failure", "model_type": "GPT-4-MoE", "dataset": "SlimPajama-subset", "num_workers": 8, "total_training_steps": 5000, "eval_every_n_steps": 100, "fault_injection": {"type": "EXPERT_FAILURE", "trigger_step": 3000, "params": {"expert_to_kill": 5}}, "r_metric_weights": {"w1_lambda": 0.0, "w2_sigma_sq": 0.5, "w3_delta_l": 0.78}, "alert_thresholds": {"r_metric": 0.57, "loss_spike": 3.0, "grad_norm": 100.0}}}
{"step": 100, "event": "METRICS", "training_loss": 3.006903846775359, "validation_loss": 3.0846739781108083, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.0, "alerts": {}}
{"step": 200, "event": "METRICS", "training_loss": 2.937637936641303, "validation_loss": 2.992331576318441, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.5, "lambda_norm": 0.0, "sigma_sq_norm": 1.0, "delta_l_norm": 0.0, "alerts": {}}
{"step": 300, "event": "METRICS", "training_loss": 2.849569918034914, "validation_loss": 2.9329285713477926, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.5, "lambda_norm": 0.0, "sigma_sq_norm": 1.0, "delta_l_norm": 0.0, "alerts": {}}
{"step": 400, "event": "METRICS", "training_loss": 2.732712476932704, "validation_loss": 2.8280702686305332, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.34462523216899954, "lambda_norm": 0.0, "sigma_sq_norm": 0.6892504643379991, "delta_l_norm": 0.0, "alerts": {}}
{"step": 500, "event": "METRICS", "training_loss": 2.7041349551317317, "validation_loss": 2.7571061590620807, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.0, "alerts": {}}
{"step": 600, "event": "METRICS", "training_loss": 2.600938187660694, "validation_loss": 2.6998365510108187, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.01937134391767544, "lambda_norm": 0.0, "sigma_sq_norm": 0.03874268783535088, "delta_l_norm": 0.0, "alerts": {}}
{"step": 700, "event": "METRICS", "training_loss": 2.4927393489099225, "validation_loss": 2.5694381055705198, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.32032991023760515, "lambda_norm": 0.0, "sigma_sq_norm": 0.6406598204752103, "delta_l_norm": 0.0, "alerts": {}}
{"step": 800, "event": "METRICS", "training_loss": 2.439074429318108, "validation_loss": 2.5201214594595327, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.016291742341866554, "lambda_norm": 0.0, "sigma_sq_norm": 0.03258348468373311, "delta_l_norm": 0.0, "alerts": {}}
{"step": 900, "event": "METRICS", "training_loss": 2.372981233498547, "validation_loss": 2.460430680203377, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.08068845062303352, "lambda_norm": 0.0, "sigma_sq_norm": 0.16137690124606704, "delta_l_norm": 0.0, "alerts": {}}
{"step": 1000, "event": "METRICS", "training_loss": 2.321581623632135, "validation_loss": 2.398423682846215, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.14440259964241764, "lambda_norm": 0.0, "sigma_sq_norm": 0.2888051992848353, "delta_l_norm": 0.0, "alerts": {}}
{"step": 1100, "event": "METRICS", "training_loss": 2.220417000324802, "validation_loss": 2.309468383582255, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.10232422882897863, "lambda_norm": 0.0, "sigma_sq_norm": 0.20464845765795725, "delta_l_norm": 0.0, "alerts": {}}
{"step": 1200, "event": "METRICS", "training_loss": 2.164361799137587, "validation_loss": 2.253415245477242, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.038723562444389285, "lambda_norm": 0.0, "sigma_sq_norm": 0.07744712488877857, "delta_l_norm": 0.0, "alerts": {}}
{"step": 1300, "event": "METRICS", "training_loss": 2.1315098713385523, "validation_loss": 2.2259820169693634, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.1877426978098302, "lambda_norm": 0.0, "sigma_sq_norm": 0.33581877114822595, "delta_l_norm": 0.02542732337912462, "alerts": {}}
{"step": 1400, "event": "METRICS", "training_loss": 1.989824654008702, "validation_loss": 2.06010876414061, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.0, "alerts": {}}
{"step": 1500, "event": "METRICS", "training_loss": 1.9774734163746785, "validation_loss": 2.0767913512676905, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.09472744469204343, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.12144544191287619, "alerts": {}}
{"step": 1600, "event": "METRICS", "training_loss": 1.9593790714497032, "validation_loss": 2.039557109884924, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.19128953303366186, "lambda_norm": 0.0, "sigma_sq_norm": 0.20592406107000044, "delta_l_norm": 0.11324038781879697, "alerts": {}}
{"step": 1700, "event": "METRICS", "training_loss": 1.8291770321850773, "validation_loss": 1.8824467106104845, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.0, "alerts": {}}
{"step": 1800, "event": "METRICS", "training_loss": 1.7588246195944186, "validation_loss": 1.8097600996856977, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.019207580696465963, "lambda_norm": 0.0, "sigma_sq_norm": 0.038415161392931926, "delta_l_norm": 0.0, "alerts": {}}
{"step": 1900, "event": "METRICS", "training_loss": 1.7014681934978806, "validation_loss": 1.7736222649998448, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.04594364688295044, "lambda_norm": 0.0, "sigma_sq_norm": 0.0895149913720896, "delta_l_norm": 0.0015207066626995388, "alerts": {}}
{"step": 2000, "event": "METRICS", "training_loss": 1.666662527295062, "validation_loss": 1.719781741919923, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.0, "alerts": {}}
{"step": 2100, "event": "METRICS", "training_loss": 1.647919324243852, "validation_loss": 1.721426771266881, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.05198913876047301, "lambda_norm": 0.0, "sigma_sq_norm": 0.009471023600760197, "delta_l_norm": 0.06058157302576014, "alerts": {}}
{"step": 2200, "event": "METRICS", "training_loss": 1.5953617021112707, "validation_loss": 1.6631777108821286, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.011168654455968229, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.01431878776406183, "alerts": {}}
{"step": 2300, "event": "METRICS", "training_loss": 1.5762798726867624, "validation_loss": 1.6719748973984256, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.08532850869050021, "lambda_norm": 0.0, "sigma_sq_norm": 0.04417179430550379, "delta_l_norm": 0.08108027120224144, "alerts": {}}
{"step": 2400, "event": "METRICS", "training_loss": 1.5389268427060894, "validation_loss": 1.6353992008038452, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.06256459354450698, "lambda_norm": 0.0, "sigma_sq_norm": 0.02214871412424921, "delta_l_norm": 0.06601312369536202, "alerts": {}}
{"step": 2500, "event": "METRICS", "training_loss": 1.4195732448478497, "validation_loss": 1.506555880504439, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.05021855585741744, "lambda_norm": 0.0, "sigma_sq_norm": 0.10043711171483488, "delta_l_norm": 0.0, "alerts": {}}
{"step": 2600, "event": "METRICS", "training_loss": 1.3625941946126, "validation_loss": 1.4459490100020318, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.05089630706711701, "lambda_norm": 0.0, "sigma_sq_norm": 0.10179261413423402, "delta_l_norm": 0.0, "alerts": {}}
{"step": 2700, "event": "METRICS", "training_loss": 1.3739783512936738, "validation_loss": 1.4325744973897545, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.01882170324693318, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.024130388778119464, "alerts": {}}
{"step": 2800, "event": "METRICS", "training_loss": 1.3006806863119014, "validation_loss": 1.3510681504889883, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.013497870950477199, "lambda_norm": 0.0, "sigma_sq_norm": 0.026995741900954398, "delta_l_norm": 0.0, "alerts": {}}
{"step": 2900, "event": "METRICS", "training_loss": 1.2765521463490455, "validation_loss": 1.3533702071582594, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.03390536952486268, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.04346842246777266, "alerts": {}}
{"step": 3000, "event": "FAULT_INJECTED", "details": "Injecting fault: EXPERT_FAILURE - Expert 5 has failed."}
{"step": 3000, "event": "METRICS", "training_loss": 58.44994584101299, "validation_loss": 58.52434700346802, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [5], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": true, "is_crashed": false, "r_metric": 0.8364501182664124, "lambda_norm": 0.0, "sigma_sq_norm": 0.1129002365328246, "delta_l_norm": 1.0, "alerts": {"r_metric": 3000, "loss_spike": 3000}}
{"step": 3000, "event": "EXPERIMENT_FAILURE", "reason": "NaN Loss"}
