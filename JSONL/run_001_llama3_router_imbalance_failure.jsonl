{"event": "EXPERIMENT_START", "config": {"experiment_id": "run_001_llama3_router_imbalance", "model_type": "Llama-3-8B", "dataset": "SlimPajama-subset", "num_workers": 8, "total_training_steps": 5000, "eval_every_n_steps": 100, "fault_injection": {"type": "ROUTER_IMBALANCE", "trigger_step": 2500, "params": {"imbalance_factor": 0.8, "expert_to_kill": 2}}, "r_metric_weights": {"w1_lambda": 0.0, "w2_sigma_sq": 0.5, "w3_delta_l": 0.78}, "alert_thresholds": {"r_metric": 0.57, "loss_spike": 3.0, "grad_norm": 100.0}}}
{"step": 100, "event": "METRICS", "training_loss": 3.100272584552394, "validation_loss": 3.1861841480255704, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.0, "alerts": {}}
{"step": 200, "event": "METRICS", "training_loss": 2.9304371954967294, "validation_loss": 2.99827679272939, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.0, "alerts": {}}
{"step": 300, "event": "METRICS", "training_loss": 2.8262884455845145, "validation_loss": 2.877550155414637, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.1436497309364757, "lambda_norm": 0.0, "sigma_sq_norm": 0.2872994618729514, "delta_l_norm": 0.0, "alerts": {}}
{"step": 400, "event": "METRICS", "training_loss": 2.811976493069212, "validation_loss": 2.888309696096286, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.9290639105830231, "lambda_norm": 0.0, "sigma_sq_norm": 0.2981278211660461, "delta_l_norm": 1.0, "alerts": {"r_metric": 400}}
{"step": 500, "event": "METRICS", "training_loss": 2.681821061038041, "validation_loss": 2.7718462012635308, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.11540767996092459, "lambda_norm": 0.0, "sigma_sq_norm": 0.23081535992184918, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 600, "event": "METRICS", "training_loss": 2.644885418782149, "validation_loss": 2.70060599766432, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.010254856060204962, "lambda_norm": 0.0, "sigma_sq_norm": 0.020509712120409924, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 700, "event": "METRICS", "training_loss": 2.5320933955730744, "validation_loss": 2.5945387653336467, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.03961400572364364, "lambda_norm": 0.0, "sigma_sq_norm": 0.07922801144728728, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 800, "event": "METRICS", "training_loss": 2.419472655660638, "validation_loss": 2.4784661987873573, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.09036243476233037, "lambda_norm": 0.0, "sigma_sq_norm": 0.18072486952466074, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 900, "event": "METRICS", "training_loss": 2.390060905139586, "validation_loss": 2.4419591102219944, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.06844304392112413, "lambda_norm": 0.0, "sigma_sq_norm": 0.06705526932184394, "delta_l_norm": 0.04476334520538737, "alerts": {"r_metric": 400}}
{"step": 1000, "event": "METRICS", "training_loss": 2.3388701589229046, "validation_loss": 2.421215140252275, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.09877475265494169, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.12663429827556627, "alerts": {"r_metric": 400}}
{"step": 1100, "event": "METRICS", "training_loss": 2.269387472797019, "validation_loss": 2.3619522088373293, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.048810899725346094, "lambda_norm": 0.0, "sigma_sq_norm": 0.05243277209932293, "delta_l_norm": 0.0289673252252367, "alerts": {"r_metric": 400}}
{"step": 1200, "event": "METRICS", "training_loss": 2.1639885022134764, "validation_loss": 2.2399917577212807, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.054225469799024525, "lambda_norm": 0.0, "sigma_sq_norm": 0.10845093959804905, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 1300, "event": "METRICS", "training_loss": 2.099000497210801, "validation_loss": 2.1690757564477434, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.011784193767684543, "lambda_norm": 0.0, "sigma_sq_norm": 0.023568387535369086, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 1400, "event": "METRICS", "training_loss": 2.037651205653711, "validation_loss": 2.101082775042391, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.060591897242263125, "lambda_norm": 0.0, "sigma_sq_norm": 0.12118379448452625, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 1500, "event": "METRICS", "training_loss": 1.9303454551164982, "validation_loss": 2.023649485699965, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 1600, "event": "METRICS", "training_loss": 1.9098575728655787, "validation_loss": 1.9944248893853984, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.10405589880518329, "lambda_norm": 0.0, "sigma_sq_norm": 0.17779370495048155, "delta_l_norm": 0.019434674781977572, "alerts": {"r_metric": 400}}
{"step": 1700, "event": "METRICS", "training_loss": 1.8333779411628477, "validation_loss": 1.9215323625559975, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 1800, "event": "METRICS", "training_loss": 1.756173889512636, "validation_loss": 1.816937310515828, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.08297469680211603, "lambda_norm": 0.0, "sigma_sq_norm": 0.16594939360423205, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 1900, "event": "METRICS", "training_loss": 1.7550979915537839, "validation_loss": 1.8407784328501162, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.10287882306213372, "lambda_norm": 0.0, "sigma_sq_norm": 0.027502916611102823, "delta_l_norm": 0.11426585225202861, "alerts": {"r_metric": 400}}
{"step": 2000, "event": "METRICS", "training_loss": 1.6607614721558763, "validation_loss": 1.7140813235720695, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.0123703137900041, "lambda_norm": 0.0, "sigma_sq_norm": 0.0247406275800082, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 2100, "event": "METRICS", "training_loss": 1.662783420283556, "validation_loss": 1.7520335416184554, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.10046774600060678, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.12880480256488047, "alerts": {"r_metric": 400}}
{"step": 2200, "event": "METRICS", "training_loss": 1.5499418774481715, "validation_loss": 1.639989835886838, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.01837813187126077, "lambda_norm": 0.0, "sigma_sq_norm": 0.03675626374252154, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 2300, "event": "METRICS", "training_loss": 1.519320707403734, "validation_loss": 1.5996761071916814, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.02516892141415357, "lambda_norm": 0.0, "sigma_sq_norm": 0.05033784282830714, "delta_l_norm": 0.0, "alerts": {"r_metric": 400}}
{"step": 2400, "event": "METRICS", "training_loss": 1.5291888441103834, "validation_loss": 1.5931325985942442, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.0, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": false, "is_crashed": false, "r_metric": 0.03285814217071019, "lambda_norm": 0.0, "sigma_sq_norm": 0.0, "delta_l_norm": 0.042125823295782294, "alerts": {"r_metric": 400}}
{"step": 2500, "event": "FAULT_INJECTED", "details": "Injecting fault: ROUTER_IMBALANCE - Imbalance factor set to 0.8."}
{"step": 2500, "event": "METRICS", "training_loss": 51.31957996509348, "validation_loss": 51.415683229830776, "learning_rate": 0.0001, "active_workers": [0, 1, 2, 3, 4, 5, 6, 7], "router_imbalance_factor": 0.8, "failed_experts": [], "force_gqa_mismatch": false, "force_rms_norm_error": false, "is_nan": true, "is_crashed": false, "r_metric": 1.28, "lambda_norm": 0.0, "sigma_sq_norm": 1.0, "delta_l_norm": 1.0, "alerts": {"r_metric": 400, "loss_spike": 2500}}
{"step": 2500, "event": "EXPERIMENT_FAILURE", "reason": "NaN Loss"}
